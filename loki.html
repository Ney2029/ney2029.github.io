<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style type="text/css">
    body {
      margin: 0;
      padding: 0;
    }
  </style>
  <title>.</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
  <script src="https://content.jwplatform.com/libraries/KB5zFt7A.js"></script>
  <script data-cfasync="false" src="//achcdn.com/script/suv4.js" data-adel="lwsu" cdnd="achcdn.com" zid="7692102"></script>
</head>
<body>
  <div id="player"></div>

  <script>
    let token = "eyJ0eXAiOiJKV1QiLCJraWQiOiJ3VTNpZklJYUxPVUFSZVJCL0ZHNmVNMVAxUU09IiwiYWxnIjoiUlMyNTYifQ.eyJhdF9oYXNoIjoiQk40SUFBTWY5c08zc2VQTmU4Y1pMQSIsInN1YiI6ImNvcm9uZWxzNTU4QGdtYWlsLmNvbSIsImJ1c2luZXNzVW5pdCI6IlNTTEEtT1RUIiwicmVnaW9ucyI6WyI4MGJiMDYxMC1mZWE5LTExZWEtYTE5MC0wYjBkNzhkOTI5NjYiLCJmOTE3Y2ZmNi0wMjVhLTQ5MTctODRkNi1mYjY4NjY5N2Q5M2MiLCIyZTE2NzIzNy1jN2JiLTQyM2ItYjYwNi1jMzExMTVhZGIxZGEiXSwiYXVkaXRUcmFja2luZ0lkIjoiOTEzZTUzMGYtYjMxNC00MWY2LTllYTQtZjY3NGZmMmRlNzZiLTQyOTQ5MjkwIiwiaXNvMkNvZGUiOiJNWCIsImlzcyI6Imh0dHBzOi8vcHJvZHJvY2suZGlyZWN0dmdvLmNvbTo0NDMvb3BlbmFtL29hdXRoMi9yZWFsbXMvcm9vdC9yZWFsbXMvc3NsYSIsInRva2VuTmFtZSI6ImlkX3Rva2VuIiwiZGV2aWNlSWQiOiI3d1k5VDdTbklzeE8ydEFMRnlIQkRNd3JiVThPTkNlWl9STVRxbUJmRXBVIiwiY3VzdG9tZXJTdGF0dXMiOiJBY3RpdmUiLCJhenAiOiJkdHZnbyIsImZhbWlseU5hbWUiOiJDT1JPTkVMIiwiYXV0aF90aW1lIjoxNzA0NDM2MTMxLCJjdXN0b21lcklkIjoiMWJkMzg0MjItNDhiOC01MDhjLThmYjEtOWRkZjRmZmQyNTQ5IiwiZXhwIjoxNzA0OTI5MDYyLCJpYXQiOjE3MDQ3NjM0NjIsImdpdmVuTmFtZSI6ImpFU1VTIiwidnJpb0RldmljZUlkIjoiNzMwNDdhYzItMzBiNi00MDE2LWJlY2ItNGU0M2JjZmUzMjk0IiwiYXVkIjoiZHR2Z28iLCJDQjEiOmZhbHNlLCJjaGFubmVscyI6WyJDSDAxMDAwMDAwMDAxMjgiLCJDSDAxMDAwMDAwMDAzMTUiLCJDSDAxMDAwMDAwMDAzMzEiLCJDSDAxMDAwMDAwMDAzNDEiXSwidnJpb0N1c3RvbWVySWQiOiIxYmQzODQyMi00OGI4LTUwOGMtOGZiMS05ZGRmNGZmZDI1NDkiLCJuYW1lIjoiakVTVVMgQ09ST05FTCIsInJlYWxtIjoiL3NzbGEiLCJjc20iOiIyIiwidG9rZW5UeXBlIjoiSldUVG9rZW4ifQ.qEi6Fv5asEASyCjvqfW6lmrAZvc5X_2TEYskdQIDVSqSbqTQSf_3ljGinxGJFZO96-0CyU-B-6reCUKYqmoeIhnNDkORc97QLa6SuUpk3_UQ7B2BILyl5mdZceuMAvBWH3zUZUWI7DTEPW5oU4V0UHZEFSJrIgWR3UbXqa9M1PdKrWHsUDIgdSGy-qu5QyS6Qg5q3-S5_RnqDVQCm7bHyMSWUlHLvyuwWjIUG7nXy9haJ7_EckIiE7Bf5OZBY0K0xdV6wQVoT1Qq65J2ga0xb5hf7Xjt48S1QhXUwJDNwAQeYKoLqQVmrsooaaMJgYjNHYMSjlcYcyUaIgNnQtBkEQ";

    // Obtener el valor del parámetro 'id' de la URL utilizando la función getParameterByName
    var channelId = getParameterByName('id');

    // Definir información para diferentes canales
    let channelInfo = {
      "GH": {
        chid: "CH0100000000341",
        keyId: "de7d7ded48b437d691966acdc8a97262",
        key: "c1696c67cf7a678932d33340135ea82b"
      },
      "GHCAMARA1": {
        chid: "CH0100000000342",
        keyId: "9551559085843488876b472cd5416000",
        key: "a7dbd673c51a4c73522e7d1a240fa7bc"
      },

      "GHCAMARA2": {
        chid: "CH0100000000343",
        keyId: "206ba28f691f34f88d8886cc42702c4c",
        key: "7830b692416a413e1f31fb81a3bdf752"
      },

      "GHCAMARA3": {
        chid: "CH0100000000340",
        keyId: "cd9941e77fc63100986acdcb6bcba661",
        key: "dc9b59d9a8397b756bdd2607c7614476"
      },
    };

    // Obtener la información del canal actual
    let currentChannel = channelInfo[channelId];

    // Verificar si se encontró información para el canal actual
    if (currentChannel) {
      fetchAuthorizationToken(token, currentChannel);
    } else {
      console.error("No se encontró información para el canal especificado en la URL.");
    }

    function fetchAuthorizationToken(token, channel) {
      // Asegúrate de que channel esté definido y tenga keyId y key
      if (channel && channel.keyId && channel.key) {
        // Crear un elemento de script dinámicamente
        var script = document.createElement('script');

        // Generar un nombre de función única para el callback
        var callbackName = 'jsonpCallback_' + Date.now();
        window[callbackName] = function (data) {
          handleJSONP(data);
          // Limpiar la función callback después de su uso
          delete window[callbackName];
          document.body.removeChild(script);
        };

        // Especificar la URL de la solicitud JSONP (incluyendo el callback)
        script.src = `https://api.directvgo.com/entitlement/v3/playback/token/authorizer?callback=${callbackName}&contentId=${channel.chid}&delay=0&isLive=true&mobileNetwork=true`;
        
        // Agregar el script a la página
        document.body.appendChild(script);
      } else {
        console.error("Información incompleta para el canal actual.");
      }
    }

    // Función de manejo de datos
    function handleJSONP(response) {
      console.log(response);
      // Puedes procesar los datos recibidos aquí
    }

    // Función getParameterByName
    function getParameterByName(name) {
      name = name.replace(/[\[]/, "\[").replace(/[\]]/, "\]");
      var regex = new RegExp("[\?&]" + name + "=([^&#]*)"),
          results = regex.exec(location.search);
      return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }
  </script>
</body>
</html>
